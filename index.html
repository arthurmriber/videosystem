<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assistente de Rotina</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background-color: #141414;
            color: #ffffff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 600;
            color: #FFD11A;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }

        .date-display {
            font-size: 1rem;
            color: #888;
        }

        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .tab {
            background: #1a1a1a;
            border: 1px solid #252525;
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #fff;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tab:hover {
            border-color: #FFD11A;
            background: #1f1f1f;
        }

        .tab.active {
            border-color: #FFD11A;
            background: #252525;
            color: #FFD11A;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .card {
            background: #1a1a1a;
            border: 1px solid #252525;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #FFD11A;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .exercise-list {
            display: grid;
                gap: 1rem;
            }

        .exercise-item {
            background: #252525;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .exercise-item:hover {
            border-color: #FFD11A;
        }

        .exercise-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .exercise-item.disabled:hover {
            border-color: #333;
        }

        .exercise-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #666;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .exercise-checkbox.checked {
            background: #FFD11A;
            border-color: #FFD11A;
        }

        .exercise-checkbox.checked::after {
            content: '✓';
            color: #141414;
            font-weight: bold;
        }

        .exercise-info {
            flex: 1;
        }

        .exercise-name {
            font-size: 1rem;
            font-weight: 500;
            color: #fff;
            margin-bottom: 0.25rem;
        }

        .exercise-details {
            font-size: 0.875rem;
            color: #666;
        }

        .start-exercise-btn {
            background: #FFD11A;
            color: #141414;
            border: none;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-left: auto;
        }

        .start-exercise-btn:hover {
            background: #FFE066;
        }

        .workout-screen {
            text-align: center;
            max-width: 600px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 100vh;
            padding: 2rem 0;
        }

        .workout-back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: #1a1a1a;
            border: 1px solid #252525;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s ease;
            z-index: 1000;
        }

        .workout-back-btn:hover {
            border-color: #FFD11A;
            color: #FFD11A;
        }

        .workout-mode .container > header,
        .workout-mode .tabs {
            display: none;
        }

        .workout-header {
            background: #1a1a1a;
            border: 1px solid #252525;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .workout-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #FFD11A;
            margin-bottom: 0.5rem;
        }

        .workout-phase {
            font-size: 1rem;
            color: #fff;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .workout-phase.resting {
            color: #4CAF50;
        }

        .exercise-image {
            width: 100%;
            max-width: 300px;
            height: 200px;
            background: #252525;
            border-radius: 12px;
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 1rem;
            position: relative;
        }

        .timer-container {
            background: #1a1a1a;
            border: 2px solid #252525;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .timer-display {
            font-size: 3rem;
            font-weight: 600;
            color: #FFD11A;
            margin-bottom: 0.5rem;
            font-family: monospace;
            transition: color 0.3s ease;
        }

        .timer-display.resting {
            color: #4CAF50;
        }

        .workout-message {
            font-size: 1rem;
            color: #FFD11A;
            margin-bottom: 0.5rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .workout-message.resting {
            color: #4CAF50;
        }

        .workout-message.completed {
            animation: completedPulse 0.5s ease-in-out;
        }

        @keyframes completedPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); color: #FFE066; }
            100% { transform: scale(1); }
        }

        .workout-info {
            background: #252525;
            border-radius: 8px;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            color: #fff;
            font-size: 0.9rem;
        }

        .progress-bar-container {
            background: #252525;
            border-radius: 10px;
            height: 20px;
            margin: 0.5rem 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: #FFD11A;
            border-radius: 10px;
            transition: width 0.3s ease;
            position: relative;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            font-size: 0.8rem;
            color: #666;
            margin-top: 0.25rem;
        }

        .workout-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .control-btn {
            background: #252525;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 0.75rem 1.5rem;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .control-btn:hover {
            border-color: #FFD11A;
        }

        .control-btn.primary {
            background: #FFD11A;
            color: #141414;
            border-color: #FFD11A;
        }

        .control-btn.primary:hover {
            background: #FFE066;
        }

        .current-exercise {
            background: #252525;
            border: 2px solid #FFD11A;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .schedule-list {
            display: grid;
            gap: 1rem;
        }

        .schedule-item {
            background: #252525;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
        }

        .schedule-item:hover {
            border-color: #FFD11A;
        }

        .schedule-time {
            font-size: 1rem;
            font-weight: 600;
            color: #FFD11A;
            min-width: 80px;
        }

        .schedule-content {
            flex: 1;
            color: #fff;
        }

        .schedule-status {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #333;
        }

        .schedule-status.completed {
            background: #FFD11A;
        }

        .skin-care-item {
            background: linear-gradient(135deg, #1a1a1a 0%, #252525 100%);
            border: 1px solid #333;
            border-radius: 12px;
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .skin-care-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            background: #FFD11A;
            color: #141414;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .skin-care-header i {
            font-size: 1.2rem;
        }

        .skin-care-steps {
            padding: 1rem;
            display: grid;
            gap: 0.75rem;
        }

        .skin-care-step {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            background: #252525;
            border-radius: 8px;
            border: 1px solid #333;
            transition: all 0.2s ease;
        }

        .skin-care-step:hover {
            background: #2a2a2a;
            border-color: #FFD11A;
        }

        .skin-care-step i {
            color: #FFD11A;
            width: 20px;
            text-align: center;
            font-size: 0.9rem;
        }

        .skin-care-step span {
            color: #fff;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .meal-options {
            display: grid;
            gap: 1rem;
        }

        .meal-option {
            background: #252525;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .meal-option:hover {
            border-color: #FFD11A;
        }

        .meal-option.selected {
            border-color: #FFD11A;
            background: #2a2a2a;
        }

        .meal-number {
            font-size: 0.875rem;
            color: #FFD11A;
            margin-bottom: 0.5rem;
        }

        .meal-description {
            color: #fff;
            font-size: 0.9rem;
        }

        .water-tracker {
            text-align: center;
        }

        .water-amount {
            font-size: 3rem;
            font-weight: 600;
            color: #FFD11A;
            margin: 2rem 0;
        }

        .water-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .water-btn {
            background: #252525;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1rem;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .water-btn:hover {
            border-color: #FFD11A;
        }

        .water-progress {
            margin-top: 2rem;
            height: 20px;
            background: #252525;
            border-radius: 10px;
            overflow: hidden;
        }

        .water-progress-bar {
            height: 100%;
            background: #FFD11A;
            transition: width 0.3s ease;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .stat-card {
            background: #252525;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 600;
            color: #FFD11A;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #666;
        }

        @media (max-width: 768px) {
            h1 {
            font-size: 2rem;
            }

            .tabs {
                flex-direction: column;
            }

            .timer-display {
                font-size: 3rem;
            }

            .workout-controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Meu Assistente de Rotina</h1>
            <div class="date-display" id="date-display"></div>
        </header>

        <div class="tabs">
            <div class="tab active" onclick="showScreen('exercises', event)">
                <i class="fas fa-dumbbell"></i>
                Exercícios
                </div>
            <div class="tab" onclick="showScreen('schedule', event)">
                <i class="fas fa-clock"></i>
                Rotina
            </div>
            <div class="tab" onclick="showScreen('meals', event)">
                <i class="fas fa-utensils"></i>
                Alimentação
                    </div>
            <div class="tab" onclick="showScreen('water', event)">
                <i class="fas fa-tint"></i>
                Água
            </div>
            <div class="tab" onclick="showScreen('stats', event)">
                <i class="fas fa-chart-line"></i>
                Estatísticas
                    </div>
                </div>
                
        <!-- Tela de Exercícios -->
        <div class="screen active" id="exercises-screen">
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-fire"></i>
                    Aquecimento
                            </div>
                <div class="exercise-list" id="warmup-list"></div>
                        </div>

            <div class="card">
                <div class="card-title">
                    <i class="fas fa-dumbbell"></i>
                    Exercícios
                    </div>
                <div class="exercise-list" id="exercises-list"></div>
                </div>
            </div>

        <!-- Tela de Treino Ativo -->
        <div class="screen" id="workout-screen">
            <div class="workout-back-btn" onclick="stopWorkout()">
                <i class="fas fa-arrow-left"></i>
        </div>
            
            <div class="workout-screen">
                <div class="workout-header">
                    <div class="workout-title" id="workout-title">Exercício</div>
                    <div class="workout-phase" id="workout-phase">Prepare-se!</div>
                    <div class="progress-bar-container" id="progress-bar-container" style="display: none;">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>
                    <div class="progress-text" id="progress-text"></div>
    </div>

                <div class="exercise-image" id="exercise-image">
                    <i class="fas fa-image" style="font-size: 3rem;"></i>
            </div>
            
                <div class="timer-container">
                    <div class="timer-display" id="timer-display">00:00</div>
                    <div class="workout-message" id="workout-message">Clique em "Iniciar" para começar</div>
                    <div class="workout-info" id="workout-info"></div>
                </div>
                
                <div class="workout-controls" id="workout-controls">
                    <button class="control-btn primary" onclick="startWorkoutTimer()">
                        <i class="fas fa-play"></i>
                        Iniciar
                    </button>
                    <button class="control-btn" onclick="skipExercise()">
                        <i class="fas fa-forward"></i>
                        Pular
                    </button>
                    <button class="control-btn" onclick="stopWorkout()">
                        <i class="fas fa-stop"></i>
                        Parar
                    </button>
                </div>
                </div>
            </div>
            
        <!-- Tela de Rotina -->
        <div class="screen" id="schedule-screen">
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-calendar-day"></i>
                    Minha Rotina Diária
                        </div>
                <div class="schedule-list" id="schedule-list"></div>
                        </div>
                    </div>

        <!-- Tela de Alimentação -->
        <div class="screen" id="meals-screen">
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-coffee"></i>
                    Café da Manhã
                </div>
                <div class="meal-options" id="breakfast-options"></div>
                    </div>

            <div class="card">
                <div class="card-title">
                    <i class="fas fa-utensils"></i>
                    Almoço
                </div>
                <div class="meal-options" id="lunch-options"></div>
            </div>
            
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-moon"></i>
                    Jantar
            </div>
                <div class="meal-options" id="dinner-options"></div>
        </div>
    </div>

        <!-- Tela de Água -->
        <div class="screen" id="water-screen">
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-tint"></i>
                    Consumo de Água
            </div>
                <div class="water-tracker">
                    <div class="water-amount" id="water-amount">0 ml</div>
                    <div class="water-buttons">
                        <button class="water-btn" onclick="addWater(200)">
                            <i class="fas fa-wine-glass"></i><br>
                            +200ml
                        </button>
                        <button class="water-btn" onclick="addWater(500)">
                            <i class="fas fa-coffee"></i><br>
                            +500ml
                        </button>
                        <button class="water-btn" onclick="addWater(1000)">
                            <i class="fas fa-wine-bottle"></i><br>
                            +1L
                        </button>
                        <button class="water-btn" onclick="removeWater(200)">
                            <i class="fas fa-minus"></i><br>
                            -200ml
                        </button>
                        <button class="water-btn" onclick="removeWater(500)">
                            <i class="fas fa-minus"></i><br>
                            -500ml
                    </button>
                </div>
                    <div class="water-progress">
                        <div class="water-progress-bar" id="water-progress-bar"></div>
                        </div>
                    <div style="margin-top: 1rem; color: #666;">
                        Meta: 3L por dia
                    </div>
                </div>
                </div>
            </div>
            
        <!-- Tela de Estatísticas -->
        <div class="screen" id="stats-screen">
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-chart-bar"></i>
                    Resumo do Dia
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="exercises-completed">0</div>
                        <div class="stat-label">Exercícios Concluídos</div>
                </div>
                    <div class="stat-card">
                        <div class="stat-value" id="meals-completed">0</div>
                        <div class="stat-label">Refeições Registradas</div>
                </div>
                    <div class="stat-card">
                        <div class="stat-value" id="water-today">0L</div>
                        <div class="stat-label">Água Consumida</div>
                </div>
                    <div class="stat-card">
                        <div class="stat-value" id="schedule-completed">0</div>
                        <div class="stat-label">Tarefas da Rotina</div>
            </div>
                </div>
                <div style="margin-top: 2rem; text-align: center;">
                    <button class="control-btn" onclick="resetAllData()" style="background: #dc3545; border-color: #dc3545;">
                        <i class="fas fa-trash"></i>
                        Resetar Todos os Dados
                </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dados da rotina
        const warmupExercises = [
            { name: 'Alongamento padrão', duration: 120, id: 'warmup-1' },
            { name: 'Polichinelo', duration: 60, id: 'warmup-2' },
            { name: 'Círculos de braços - Frente', duration: 30, id: 'warmup-3' },
            { name: 'Círculos de braços - Trás', duration: 30, id: 'warmup-4' },
            { name: 'High Knees', duration: 60, id: 'warmup-5' }
        ];

        const exercises = [
            { name: 'Flexões', sets: 3, duration: 35, rest: 20, id: 'ex-1', description: 'mãos na largura dos ombros, corpo reto', muscles: 'Peito, ombros, tríceps, core' },
            { name: 'Agachamento', sets: 3, duration: 35, rest: 20, id: 'ex-2', description: 'pés na largura dos ombros, até 90°', muscles: 'Quadríceps, glúteos, posterior de coxa, core' },
            { name: 'Bent-over Rows (com mochila)', sets: 3, duration: 35, rest: 20, id: 'ex-3', description: 'com mochila, incline o tronco, puxe até o peito', muscles: 'Costas, dorsais, bíceps' },
            { name: 'Chair Dips', sets: 3, duration: 35, rest: 20, id: 'ex-4', description: 'mãos em cadeira/sofá, dobrar cotovelos até 90°', muscles: 'Tríceps, ombros, peito' },
            { name: 'Mountain Climbers', sets: 3, duration: 35, rest: 20, id: 'ex-5', description: 'posição de flexão, leve joelhos alternadamente', muscles: 'Core, ombros, cardio' },
            { name: 'Bicycle Crunches', sets: 3, duration: 35, rest: 20, id: 'ex-6', description: 'toque cotovelo no joelho oposto', muscles: 'Abdômen, oblíquos' },
            { name: 'Prancha', sets: 3, duration: 35, rest: 20, id: 'ex-7', description: 'apoie antebraços, corpo reto', muscles: 'Core, ombros, estabilidade' },
            { name: 'Abdominal', sets: 3, duration: 35, rest: 20, id: 'ex-8', description: 'levar o corpo até os joelhos', muscles: 'Abdômen' }
        ];

        const schedule = [
            { time: '6:30', activity: 'Acordar', id: 'sched-1' },
            { time: '6:35', activity: 'Skin Care - Manhã: Lavar rosto com sabonete em gel, massagear 30s, enxaguar com água fria, aplicar hidratante', id: 'sched-2' },
            { time: '6:40', activity: 'Café da manhã leve (1 banana ou uma fruta)', id: 'sched-3' },
            { time: '6:50', activity: 'Treino (30 min)', id: 'sched-4' },
            { time: '7:30', activity: 'Café da manhã + Preparar chimarrão', id: 'sched-5' },
            { time: '8:00', activity: 'Trabalho', id: 'sched-6' },
            { time: '11:30', activity: 'Caminhada (40 min)', id: 'sched-7' },
            { time: '12:30', activity: 'Almoço', id: 'sched-8' },
            { time: '13:00', activity: 'Trabalho', id: 'sched-9' },
            { time: '15:30', activity: 'Lanche (1 fruta)', id: 'sched-10' },
            { time: '18:00', activity: 'Finalizar trabalho', id: 'sched-11' },
            { time: '19:00', activity: 'Jantar', id: 'sched-12' },
            { time: '20:00', activity: 'Tempo livre', id: 'sched-13' },
            { time: '22:00', activity: 'Banho/preparando para dormir', id: 'sched-14' },
            { time: '22:15', activity: 'Skin Care - Noite: Lavar com sabonete de enxofre (2min), depois sabonete em gel, hidratante facial', id: 'sched-15' },
            { time: '22:30', activity: 'Dormir', id: 'sched-16' }
        ];

        const mealOptions = {
            breakfast: [
                '2 ovos mexidos + 1 fatia de pão integral + 1 banana',
                'Iogurte natural + 3 colheres de aveia + 1 maçã',
                'Omelete com 2 ovos + tomate + espinafre',
                'Tapioca com 1 ovo + 1 fatia de queijo branco',
                'Vitamina: 1 banana + 200 ml leite desnatado + 1 colher de aveia',
                '1 fatia de pão integral + 1 ovo cozido + 1 fruta',
                '2 ovos cozidos + tomate + pepino',
                'Smoothie: iogurte + mamão + chia',
                'Omelete com legumes variados (cenoura, abobrinha)',
                '1 fatia de pão integral + pasta de ricota ou queijo branco + fruta'
            ],
            lunch: [
                'Frango grelhado + arroz integral + salada + 1 colher de azeite',
                'Peixe assado + batata doce + brócolis + 1 colher de azeite',
                'Carne magra (patinho/coxão mole) + arroz integral + feijão + salada',
                'Omelete de 3 ovos + frango desfiado + abóbora cozida + salada',
                'Peito de frango + quinoa + mix de vegetais + 1 colher de azeite',
                'Carne magra + batata doce + salada de folhas',
                'Frango grelhado + feijão + couve refogada + 1 colher de azeite',
                'Peixe + arroz integral + brócolis + cenoura',
                'Carne magra + purê de abóbora + salada',
                'Frango assado + arroz integral + legumes cozidos + azeite'
            ],
            dinner: [
                'Peixe grelhado + brócolis + cenoura + 1 colher de azeite',
                'Frango desfiado + salada + abóbora cozida',
                'Omelete 2–3 ovos + espinafre + cogumelos',
                'Carne magra grelhada + legumes no vapor + 1 colher de azeite',
                'Frango ou peixe + salada crua variada + azeite',
                'Peixe assado + couve + cenoura cozida',
                'Omelete com frango desfiado + abobrinha refogada',
                'Peito de frango + mix de legumes + pouco arroz integral',
                'Carne magra + salada + purê de abóbora',
                'Frango grelhado + brócolis + couve + 1 colher de azeite'
            ]
        };

        // Estado da aplicação
        let state = {
            exercises: {},
            schedule: {},
            meals: { breakfast: null, lunch: null, dinner: null },
            water: 0,
            workoutActive: false,
            currentExerciseIndex: null,
            currentSet: 1,
            timerRunning: false,
            timerInterval: null,
            timeRemaining: 0,
            workoutPhase: 'waiting' // waiting, exercise, rest
        };

        // Carrega estado do localStorage e reseta se mudou o dia
        function loadState() {
            const saved = localStorage.getItem('routine-state');
            const today = new Date().toDateString();
            
            if (saved) {
                const parsed = JSON.parse(saved);
                if (parsed.date === today) {
                    state = { ...state, ...parsed.data };
                } else {
                    // Reset ao mudar o dia
                    state = {
                        exercises: {},
                        schedule: {},
                        meals: { breakfast: null, lunch: null, dinner: null },
                        water: 0,
                        workoutActive: false,
                        currentExerciseIndex: null,
                        currentSet: 1,
                        timerRunning: false,
                        timerInterval: null,
                        timeRemaining: 0,
                        workoutPhase: 'waiting'
                    };
                    saveState();
                }
            }
        }

        // Salva estado no localStorage
        function saveState() {
            const today = new Date().toDateString();
            localStorage.setItem('routine-state', JSON.stringify({
                date: today,
                data: state
            }));
        }

        // Mostra a data atual
        function updateDate() {
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('date-display').textContent = now.toLocaleDateString('pt-BR', options);
        }

        // Alterna entre telas
        function showScreen(screenName, event) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            
            document.getElementById(screenName + '-screen').classList.add('active');
            if (event) {
                event.target.closest('.tab').classList.add('active');
            }
        }

        // Verifica se todos os alongamentos foram completados
        function areAllWarmupsCompleted() {
            return warmupExercises.every(ex => state.exercises[ex.id]);
        }

        // Renderiza exercícios
        function renderExercises() {
            const warmupList = document.getElementById('warmup-list');
            warmupList.innerHTML = warmupExercises.map(ex => `
                <div class="exercise-item">
                    <div class="exercise-checkbox ${state.exercises[ex.id] ? 'checked' : ''}" onclick="toggleExercise('${ex.id}')"></div>
                    <div class="exercise-info" onclick="toggleExercise('${ex.id}')">
                        <div class="exercise-name">${ex.name}</div>
                        <div class="exercise-details">${ex.duration}s</div>
                    </div>
                    <button class="start-exercise-btn" onclick="startSingleExercise('${ex.id}')">
                        <i class="fas fa-play"></i> Iniciar
                    </button>
                </div>
            `).join('');

            const exercisesList = document.getElementById('exercises-list');
            const warmupsDone = areAllWarmupsCompleted();
            
            exercisesList.innerHTML = exercises.map(ex => `
                <div class="exercise-item ${!warmupsDone ? 'disabled' : ''}">
                    <div class="exercise-checkbox ${state.exercises[ex.id] ? 'checked' : ''}" onclick="${warmupsDone ? `toggleExercise('${ex.id}')` : ''}"></div>
                    <div class="exercise-info" onclick="${warmupsDone ? `toggleExercise('${ex.id}')` : ''}">
                        <div class="exercise-name">${ex.name}</div>
                        <div class="exercise-details">${ex.sets} séries × ${ex.duration}s (descanso ${ex.rest}s)</div>
                        <div class="exercise-details" style="color: #888; font-size: 0.75rem;">${ex.description}</div>
                        ${!warmupsDone ? '<div class="exercise-details" style="color: #FFD11A; font-size: 0.75rem;">⏳ Complete os alongamentos primeiro</div>' : ''}
                    </div>
                    <button class="start-exercise-btn" onclick="${warmupsDone ? `startSingleExercise('${ex.id}')` : ''}" ${!warmupsDone ? 'disabled' : ''}>
                        <i class="fas fa-play"></i> Iniciar
                    </button>
                </div>
            `).join('');
        }

        // Alterna estado do exercício
        function toggleExercise(id) {
            state.exercises[id] = !state.exercises[id];
            saveState();
            renderExercises();
            updateStats();
        }

        // Inicia exercício individual
        function startSingleExercise(id) {
            const allExercises = [...warmupExercises, ...exercises];
            const exerciseIndex = allExercises.findIndex(ex => ex.id === id);
            
            if (exerciseIndex === -1) return;
            
            // Limpa qualquer timer anterior
            if (state.timerInterval) {
                clearInterval(state.timerInterval);
                state.timerInterval = null;
            }
            
            state.workoutActive = true;
            state.currentExerciseIndex = exerciseIndex;
            state.currentSet = 1;
            state.timerRunning = false;
            state.timeRemaining = 0;
            state.workoutPhase = 'waiting';
            
            // Ativa modo workout (oculta header e tabs)
            document.body.classList.add('workout-mode');
            
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById('workout-screen').classList.add('active');
            
            showCurrentExercise();
        }

        // Mostra exercício atual
        function showCurrentExercise() {
            const allExercises = [...warmupExercises, ...exercises];
            const exercise = allExercises[state.currentExerciseIndex];
            
            // Atualiza título e fase
            document.getElementById('workout-title').textContent = exercise.name;
            
            // Atualiza imagem do exercício
            const exerciseImage = document.getElementById('exercise-image');
            const exerciseGifs = {
                'Flexões': 'https://i.pinimg.com/originals/5e/73/3d/5e733d1ee2cf199744564b83cda34d7a.gif',
                'Agachamento': 'https://treinoemcasa.com/cdn/shop/articles/squat_d0f62bc3-55ce-4180-bde8-005b5adedf9f.gif',
                'Bent-over Rows (com mochila)': 'https://cdn.shopify.com/s/files/1/0449/8453/3153/files/Bent_Over_Row.gif?v=1689836376',
                'Chair Dips': 'https://cdn.jefit.com/assets/img/exercises/gifs/229.gif',
                'Mountain Climbers': 'https://cdn.jefit.com/assets/img/exercises/gifs/484.gif',
                'Bicycle Crunches': 'https://hips.hearstapps.com/hmg-prod/images/workouts/2016/08/bicycle-1472058017.gif?resize=980:*',
                'Prancha': 'https://i.pinimg.com/originals/f7/4c/37/f74c37422c0ca0c43d499f9da94a1a7f.gif',
                'Abdominal': 'https://i.pinimg.com/originals/fb/7d/88/fb7d88e46efd63d70963c84c02974414.gif',
                'High Knees': 'https://hips.hearstapps.com/hmg-prod/images/workouts/2016/03/highkneerun-1457044203.gif'
            };
            
            if (exerciseGifs[exercise.name]) {
                exerciseImage.innerHTML = `
                    <img src="${exerciseGifs[exercise.name]}" 
                         alt="${exercise.name}" 
                         style="width: 100%; height: 100%; object-fit: cover; border-radius: 12px;">
                    ${exercise.name.includes('mochila') ? `
                        <div style="position: absolute; top: 10px; right: 10px; background: #FFD11A; color: #141414; padding: 0.5rem; border-radius: 8px; font-size: 0.8rem; font-weight: 600; box-shadow: 0 2px 8px rgba(0,0,0,0.3);">
                            <i class="fas fa-backpack"></i> Use mochila
                        </div>
                    ` : ''}
                `;
            } else {
                exerciseImage.innerHTML = '<i class="fas fa-image" style="font-size: 3rem;"></i>';
            }
            
            // Atualiza progresso visual
            updateWorkoutProgress();
            
            // Configura controles dependendo da fase
            const controlsDiv = document.getElementById('workout-controls');
            const hasSets = exercise.sets && exercise.sets > 1;
            
            if (state.workoutPhase === 'waiting') {
                document.getElementById('workout-phase').textContent = 'Prepare-se!';
                document.getElementById('workout-phase').className = 'workout-phase';
                document.getElementById('workout-message').textContent = 'Clique em "Iniciar" para começar';
                
                controlsDiv.innerHTML = `
                    <button class="control-btn primary" onclick="startWorkoutTimer()">
                        <i class="fas fa-play"></i>
                        Iniciar Exercício
                    </button>
                `;
                
                if (hasSets) {
                    document.getElementById('workout-info').textContent = 
                        `${exercise.sets} séries de ${exercise.duration}s com ${exercise.rest}s de descanso`;
                } else {
                    document.getElementById('workout-info').textContent = `${exercise.duration}s`;
                }
                // Define o tempo correto
                state.timeRemaining = exercise.duration;
                updateTimerDisplay();
            } else if (state.workoutPhase === 'exercise') {
                document.getElementById('workout-phase').textContent = `Série ${state.currentSet}/${exercise.sets || 1}`;
                document.getElementById('workout-phase').className = 'workout-phase';
                document.getElementById('workout-message').textContent = state.timerRunning ? 'Exercitando...' : 'Pronto para começar';
                document.getElementById('workout-message').className = 'workout-message';
                document.getElementById('timer-display').className = 'timer-display';
                
                controlsDiv.innerHTML = `
                    <button class="control-btn ${state.timerRunning ? '' : 'primary'}" onclick="pauseResumeWorkout()">
                        <i class="fas fa-${state.timerRunning ? 'pause' : 'play'}"></i>
                        ${state.timerRunning ? 'Pausar' : 'Retomar'}
                            </button>
                `;
            } else if (state.workoutPhase === 'rest') {
                document.getElementById('workout-phase').textContent = `Descanso - Série ${state.currentSet}/${exercise.sets}`;
                document.getElementById('workout-phase').className = 'workout-phase resting';
                document.getElementById('workout-message').textContent = state.timerRunning ? 'Descansando...' : 'Pronto para descansar';
                document.getElementById('workout-message').className = 'workout-message resting';
                document.getElementById('timer-display').className = 'timer-display resting';
                
                controlsDiv.innerHTML = `
                    <button class="control-btn ${state.timerRunning ? '' : 'primary'}" onclick="pauseResumeWorkout()">
                        <i class="fas fa-${state.timerRunning ? 'pause' : 'play'}"></i>
                        ${state.timerRunning ? 'Pausar' : 'Retomar'}
                        </button>
                    <button class="control-btn" onclick="skipRestPhase()">
                        <i class="fas fa-forward"></i>
                        Pular Descanso
                        </button>
                `;
            }
        }

        // Atualiza progresso visual do treino
        function updateWorkoutProgress() {
            const allExercises = [...warmupExercises, ...exercises];
            const exercise = allExercises[state.currentExerciseIndex];
            const progressContainer = document.getElementById('progress-bar-container');
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            
            if (!exercise.sets || exercise.sets === 1) {
                // Exercício simples - sem progresso visual
                progressContainer.style.display = 'none';
                return;
            }
            
            // Exercício com séries - mostra barra de progresso
            progressContainer.style.display = 'block';
            
            // Calcula progresso baseado na série atual
            let progress = 0;
            if (state.currentSet === 1) {
                progress = 33; // Série 1 = 1/3 da barra
            } else if (state.currentSet === 2) {
                progress = 66; // Série 2 = 2/3 da barra
            } else if (state.currentSet === 3) {
                progress = 100; // Série 3 = barra completa
            }
            
            progressBar.style.width = progress + '%';
            progressText.textContent = `Série ${state.currentSet} de ${exercise.sets}`;
        }

        // Inicia timer do treino
        function startWorkoutTimer() {
            const allExercises = [...warmupExercises, ...exercises];
            const exercise = allExercises[state.currentExerciseIndex];
            
            if (state.workoutPhase === 'waiting') {
                state.workoutPhase = 'exercise';
                state.timeRemaining = exercise.duration;
                showCurrentExercise();
            }
            
            state.timerRunning = true;
            state.timerInterval = setInterval(() => {
                state.timeRemaining--;
                updateTimerDisplay();
                
                if (state.timeRemaining <= 0) {
                    clearInterval(state.timerInterval);
                    completeCurrentPhase();
                }
            }, 1000);
            
            showCurrentExercise();
        }

        // Atualiza display do timer
        function updateTimerDisplay() {
            const minutes = Math.floor(state.timeRemaining / 60);
            const seconds = state.timeRemaining % 60;
            document.getElementById('timer-display').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Completa fase atual
        function completeCurrentPhase() {
            const allExercises = [...warmupExercises, ...exercises];
            const exercise = allExercises[state.currentExerciseIndex];
            
            if (state.workoutPhase === 'exercise') {
                // Caso 1: Exercício simples (sem séries ou alongamento)
                if (!exercise.sets || exercise.sets === 1) {
                    state.exercises[exercise.id] = true;
                    saveState();
                    const messageEl = document.getElementById('workout-message');
                    messageEl.textContent = '✓ Exercício Concluído!';
                    messageEl.classList.add('completed');
                    document.getElementById('workout-info').textContent = 'Parabéns!';
                    
                    setTimeout(() => messageEl.classList.remove('completed'), 500);
                    setTimeout(() => moveToNextExercise(), 2000);
                }
                // Caso 2: Exercício com séries - série completa, mas ainda tem mais
                else if (state.currentSet < exercise.sets) {
                    // Próxima série existe, vamos para descanso
                    state.workoutPhase = 'rest';
                    state.timeRemaining = exercise.rest;
                    
                    const messageEl = document.getElementById('workout-message');
                    messageEl.textContent = `✓ Série ${state.currentSet}/${exercise.sets} completa!`;
                    messageEl.classList.add('completed');
                    document.getElementById('workout-info').textContent = 
                        `Descanso: ${exercise.rest}s - Próxima série: ${state.currentSet + 1}/${exercise.sets}`;
                    
                    showCurrentExercise();
                    setTimeout(() => messageEl.classList.remove('completed'), 500);
                    
                    // Inicia descanso automaticamente
                    state.timerRunning = true;
                    state.timerInterval = setInterval(() => {
                        state.timeRemaining--;
                        updateTimerDisplay();
                        
                        if (state.timeRemaining <= 0) {
                            clearInterval(state.timerInterval);
                            completeCurrentPhase();
                        }
                    }, 1000);
                }
                // Caso 3: Última série completa
                else {
                    state.exercises[exercise.id] = true;
                    saveState();
                    const messageEl = document.getElementById('workout-message');
                    messageEl.textContent = '✓ Exercício Concluído!';
                    messageEl.classList.add('completed');
                    document.getElementById('workout-info').textContent = 'Parabéns!';
                    
                    setTimeout(() => messageEl.classList.remove('completed'), 500);
                    setTimeout(() => moveToNextExercise(), 2000);
                }
            } 
            else if (state.workoutPhase === 'rest') {
                // Descanso terminou, vai para próxima série do exercício
                state.currentSet++;
                state.workoutPhase = 'exercise';
                state.timeRemaining = exercise.duration;
                state.timerRunning = false; // Não iniciar automaticamente
                
                // Limpa qualquer timer anterior
                if (state.timerInterval) {
                    clearInterval(state.timerInterval);
                    state.timerInterval = null;
                }
                
                // Atualiza display do timer imediatamente
                updateTimerDisplay();
                
                document.getElementById('workout-message').textContent = `Próxima série: ${state.currentSet}/${exercise.sets}`;
                document.getElementById('workout-info').textContent = 
                    `${exercise.sets - state.currentSet === 0 ? 'Última série!' : `Faltam ${exercise.sets - state.currentSet} séries. Vamos lá!`}`;
                
                showCurrentExercise();
                
                // Inicia automaticamente o timer da nova série
                setTimeout(() => {
                    startWorkoutTimer();
                }, 1000);
            }
        }

        // Move para o próximo exercício
        function moveToNextExercise() {
            const allExercises = [...warmupExercises, ...exercises];
            
            // Procura o próximo exercício não completado
            let nextIndex = state.currentExerciseIndex + 1;
            while (nextIndex < allExercises.length && state.exercises[allExercises[nextIndex].id]) {
                nextIndex++;
            }
            
            if (nextIndex < allExercises.length) {
                // Há próximo exercício
                state.currentExerciseIndex = nextIndex;
                state.currentSet = 1;
                state.workoutPhase = 'waiting';
                state.timerRunning = false;
                if (state.timerInterval) {
                    clearInterval(state.timerInterval);
                }
                // Remove animação se houver
                document.getElementById('workout-message').classList.remove('completed');
                showCurrentExercise();
                } else {
                // Não há mais exercícios, volta para a tela principal
                stopWorkout();
            }
        }

        // Pausa/retoma treino
        function pauseResumeWorkout() {
            if (state.timerRunning) {
                clearInterval(state.timerInterval);
                state.timerRunning = false;
            } else {
                state.timerRunning = true;
                state.timerInterval = setInterval(() => {
                    state.timeRemaining--;
                    updateTimerDisplay();
                    
                    if (state.timeRemaining <= 0) {
                        clearInterval(state.timerInterval);
                        completeCurrentPhase();
                    }
                }, 1000);
            }
            showCurrentExercise();
        }

        // Pula fase de descanso
        function skipRestPhase() {
            if (state.workoutPhase === 'rest') {
                // Limpa timer do descanso
                if (state.timerInterval) {
                    clearInterval(state.timerInterval);
                    state.timerInterval = null;
                }
                state.timerRunning = false;
                // Vai para próxima série
                completeCurrentPhase();
            }
        }

        // Para treino
        function stopWorkout() {
            clearInterval(state.timerInterval);
            state.workoutActive = false;
            state.timerRunning = false;
            state.workoutPhase = 'waiting';
            
            // Remove modo workout (mostra header e tabs)
            document.body.classList.remove('workout-mode');
            
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            
            document.getElementById('exercises-screen').classList.add('active');
            document.querySelectorAll('.tab')[0].classList.add('active');
            
            renderExercises();
            updateStats();
        }

        // Renderiza rotina
        function renderSchedule() {
            const scheduleList = document.getElementById('schedule-list');
            scheduleList.innerHTML = schedule.map(item => {
                const isSkinCare = item.activity.includes('Skin Care');
                const skinCareType = item.activity.includes('Manhã') ? 'morning' : 'night';
                
                return `
                    <div class="schedule-item ${isSkinCare ? 'skin-care-item' : ''}" onclick="toggleSchedule('${item.id}')">
                        <div class="schedule-time">${item.time}</div>
                        <div class="schedule-content">
                            ${isSkinCare ? `
                                <div class="skin-care-header">
                                    <i class="fas fa-${skinCareType === 'morning' ? 'sun' : 'moon'}"></i>
                                    <span>Skin Care - ${skinCareType === 'morning' ? 'Manhã' : 'Noite'}</span>
                                </div>
                                <div class="skin-care-steps">
                                    ${skinCareType === 'morning' ? `
                                        <div class="skin-care-step">
                                            <i class="fas fa-hand-holding-water"></i>
                                            <span>Lavar rosto com sabonete em gel</span>
                                        </div>
                                        <div class="skin-care-step">
                                            <i class="fas fa-clock"></i>
                                            <span>Massagear por 30 segundos</span>
                                        </div>
                                        <div class="skin-care-step">
                                            <i class="fas fa-thermometer-empty"></i>
                                            <span>Enxaguar com água fria</span>
                                        </div>
                                        <div class="skin-care-step">
                                            <i class="fas fa-tint"></i>
                                            <span>Aplicar hidratante (pouca quantidade)</span>
                                        </div>
                                    ` : `
                                        <div class="skin-care-step">
                                            <i class="fas fa-burn"></i>
                                            <span>Lavar com sabonete de enxofre</span>
                                        </div>
                                        <div class="skin-care-step">
                                            <i class="fas fa-clock"></i>
                                            <span>Deixar agir por 2 minutos (só a espuma)</span>
                                        </div>
                                        <div class="skin-care-step">
                                            <i class="fas fa-hand-holding-water"></i>
                                            <span>Sabonete em gel para remover odor</span>
                                        </div>
                                        <div class="skin-care-step">
                                            <i class="fas fa-tint"></i>
                                            <span>Hidratante facial</span>
                                        </div>
                                    `}
                                </div>
                            ` : item.activity}
                        </div>
                        <div class="schedule-status ${state.schedule[item.id] ? 'completed' : ''}"></div>
                    </div>
                `;
            }).join('');
        }

        // Alterna estado da rotina
        function toggleSchedule(id) {
            state.schedule[id] = !state.schedule[id];
            saveState();
            renderSchedule();
            updateStats();
        }

        // Renderiza refeições
        function renderMeals() {
            const renderMealOptions = (type, elementId) => {
                const element = document.getElementById(elementId);
                element.innerHTML = mealOptions[type].map((meal, index) => `
                    <div class="meal-option ${state.meals[type] === index ? 'selected' : ''}" onclick="selectMeal('${type}', ${index})">
                        <div class="meal-number">Opção ${index + 1}</div>
                        <div class="meal-description">${meal}</div>
                    </div>
                `).join('');
            };

            renderMealOptions('breakfast', 'breakfast-options');
            renderMealOptions('lunch', 'lunch-options');
            renderMealOptions('dinner', 'dinner-options');
        }

        // Seleciona refeição
        function selectMeal(type, index) {
            state.meals[type] = state.meals[type] === index ? null : index;
            saveState();
            renderMeals();
            updateStats();
        }

        // Adiciona água
        function addWater(amount) {
            state.water = Math.max(0, state.water + amount);
            saveState();
            updateWaterDisplay();
            updateStats();
        }

        // Remove água
        function removeWater(amount) {
            state.water = Math.max(0, state.water - amount);
            saveState();
            updateWaterDisplay();
            updateStats();
        }

        // Atualiza display de água
        function updateWaterDisplay() {
            const liters = (state.water / 1000).toFixed(1);
            document.getElementById('water-amount').textContent = `${liters}L`;
            
            const percentage = Math.min(100, (state.water / 3000) * 100);
            document.getElementById('water-progress-bar').style.width = percentage + '%';
        }

        // Atualiza estatísticas
        function updateStats() {
            const exercisesCompleted = Object.values(state.exercises).filter(v => v).length;
            const mealsCompleted = Object.values(state.meals).filter(v => v !== null).length;
            const scheduleCompleted = Object.values(state.schedule).filter(v => v).length;
            
            document.getElementById('exercises-completed').textContent = exercisesCompleted;
            document.getElementById('meals-completed').textContent = mealsCompleted;
            document.getElementById('water-today').textContent = (state.water / 1000).toFixed(1) + 'L';
            document.getElementById('schedule-completed').textContent = scheduleCompleted;
        }

        // Resetar todos os dados
        function resetAllData() {
            if (confirm('⚠️ ATENÇÃO: Esta ação irá apagar TODOS os seus dados do dia atual.\n\nIsso inclui:\n• Exercícios concluídos\n• Refeições selecionadas\n• Água consumida\n• Tarefas da rotina\n\nTem certeza que deseja continuar?')) {
                // Limpa localStorage
                localStorage.removeItem('routineAssistantState');
                
                // Reseta estado
                state = {
                    exercises: {},
                    schedule: {},
                    meals: {},
                    water: 0,
                    workoutActive: false,
                    currentExerciseIndex: 0,
                    currentSet: 1,
                    timerRunning: false,
                    timerInterval: null,
                    timeRemaining: 0,
                    workoutPhase: 'waiting'
                };
                
                // Recarrega interface
                renderExercises();
                renderSchedule();
                renderMeals();
                updateWaterDisplay();
                updateStats();
                
                alert('✅ Todos os dados foram resetados com sucesso!');
            }
        }

        // Inicialização
        window.addEventListener('DOMContentLoaded', () => {
            loadState();
            updateDate();
            renderExercises();
            renderSchedule();
            renderMeals();
            updateWaterDisplay();
            updateStats();
        });
    </script>
</body>
</html>
